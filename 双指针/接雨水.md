# 接雨水（困难）

## 题目

给定 `n` 个非负整数表示每个宽度为 1 的柱子的高度图，计算按此排列的柱子，下雨之后能接多少雨水。

## 示例

```
输入：height = [0,1,0,2,1,0,1,3,2,1,2,1]
输出：6
```

```
输入：height = [4,2,0,3,2,5]
输出：9
```

## 解法

### 对撞双指针 ✓

核心思想：每个位置 `i` 能存的水量 = `min(left_max, right_max) - height[i]`。

用左右双指针从两端向中间逼近，维护 `left_max` 和 `right_max`。短板一侧的水量是确定的（另一边一定有更高的柱子兜着），所以每次移动短板侧的指针并累加水量。

```python
class Solution:
    def trap(self, height: List[int]) -> int:
        l = len(height)
        if l <= 2:
            return 0
        left, right = 0, l - 1
        left_max, right_max = 0, 0
        res = 0
        while left < right:
            if height[left] > left_max:
                left_max = height[left]
            if height[right] > right_max:
                right_max = height[right]
            if left_max <= right_max:
                res += left_max - height[left]
                left += 1
            else:
                res += right_max - height[right]
                right -= 1
        return res
```

## 复杂度

| | 对撞双指针 |
|------|------|
| 时间 | O(n) |
| 空间 | O(1) |

## 要点

1. **按位置思考**：不要按"段"算水量，而是每个位置独立算——它能存多少水取决于左右两边最高柱子中较矮的那个
2. **短板决定水量**：`left_max < right_max` 时，左侧水量确定（右边一定有更高的兜着），移动左指针；反之移动右指针
3. **与"盛最多水的容器"对比**：同样是对撞双指针 + 短板思想，但接雨水是累加每个位置的水量，盛水是求最大面积
